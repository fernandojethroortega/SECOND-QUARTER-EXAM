<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Online Exam Presentation System</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: white;
    text-align: center;
    margin: 0;
    height: 100vh;
    overflow: hidden;
  }

  h1 {
    font-size: 2.5em;
    margin-top: 20px;
  }

  textarea {
    width: 80%;
    height: 200px;
    font-size: 1.1em;
    border-radius: 10px;
    border: none;
    padding: 10px;
    resize: none;
  }

  button {
    background-color: #ffcc00;
    border: none;
    color: black;
    font-weight: bold;
    padding: 10px 20px;
    border-radius: 10px;
    cursor: pointer;
    margin: 10px;
    transition: 0.3s;
  }

  button:hover {
    background-color: #ffaa00;
  }

  #examContainer {
    display: none;
    margin-top: 40px;
  }

  #question {
    font-size: 2em;
    margin: 30px auto 10px;
    width: 80%;
  }

  .option {
    font-size: 1.5em;
    margin: 10px 0;
  }

  #timerCircle {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 100px;
    height: 100px;
    background: #ffcc00;
    color: black;
    border-radius: 50%;
    font-size: 2em;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
  }

  #fullscreenBtn {
    position: fixed;
    top: 25px;
    right: 25px;
    background: #ffffff33;
    border: none;
    color: white;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 1.2em;
    cursor: pointer;
  }

  #fullscreenBtn:hover {
    background: #ffffff55;
  }

  #readBtn {
    background-color: #00ffcc;
    color: black;
  }

  #readBtn:hover {
    background-color: #00e0aa;
  }

  select {
    font-size: 1em;
    padding: 5px 10px;
    border-radius: 5px;
  }

</style>
</head>
<body>

<h1>ðŸ§  Online Exam Presentation System</h1>
<textarea id="examInput" placeholder="Paste your exam text here (e.g., 1. Question ... A. ... B. ... etc.)"></textarea><br>
<button id="startExam">Start Exam</button>

<div id="examContainer">
  <div id="timerCircle">60</div>
  <button id="fullscreenBtn" title="Toggle Full Screen">â›¶</button>
  <div id="question"></div>
  <div id="options"></div>
  <div>
    <button id="prevBtn">Previous</button>
    <button id="nextBtn">Next</button>
    <button id="repeatBtn" style="display:none;">Repeat Exam</button>
    <button id="readBtn">ðŸ”Š Read Question</button>
  </div>
  <div style="margin-top:10px;">
    <label>Go to Item:</label>
    <select id="jumpSelect"></select>
  </div>
</div>

<script>
let questions = [];
let currentIndex = 0;
let timer = 60;
let timerInterval;
const examInput = document.getElementById("examInput");
const startExam = document.getElementById("startExam");
const examContainer = document.getElementById("examContainer");
const questionDiv = document.getElementById("question");
const optionsDiv = document.getElementById("options");
const timerCircle = document.getElementById("timerCircle");
const nextBtn = document.getElementById("nextBtn");
const prevBtn = document.getElementById("prevBtn");
const repeatBtn = document.getElementById("repeatBtn");
const jumpSelect = document.getElementById("jumpSelect");
const readBtn = document.getElementById("readBtn");
const fullscreenBtn = document.getElementById("fullscreenBtn");

startExam.onclick = () => {
  const text = examInput.value.trim();
  if (!text) return alert("Please paste exam text first!");
  questions = parseQuestions(text);
  if (questions.length === 0) return alert("No valid questions found!");
  examInput.style.display = "none";
  startExam.style.display = "none";
  examContainer.style.display = "block";
  buildJumpList();
  currentIndex = 0;
  showQuestion();
  startTimer();
};

function parseQuestions(text) {
  const lines = text.split(/\r?\n/).map(l => l.trim()).filter(l => l !== "");
  const parsed = [];
  let currentQ = null;

  lines.forEach(line => {
    const qMatch = line.match(/^(\d+[\.\)\-])\s*(.*)/);
    const optMatch = line.match(/^([A-Da-d][\.\)\-])\s*(.*)/);
    if (qMatch) {
      if (currentQ) parsed.push(currentQ);
      currentQ = { question: qMatch[2].trim(), options: [] };
    } else if (optMatch && currentQ) {
      currentQ.options.push(optMatch[2].trim());
    }
  });
  if (currentQ) parsed.push(currentQ);
  return parsed;
}

function showQuestion() {
  const q = questions[currentIndex];
  questionDiv.textContent = `${currentIndex + 1}. ${q.question}`;
  optionsDiv.innerHTML = "";
  q.options.forEach((opt, i) => {
    const div = document.createElement("div");
    div.className = "option";
    div.textContent = `${String.fromCharCode(65 + i)}. ${opt}`;
    optionsDiv.appendChild(div);
  });
  timer = 60;
  timerCircle.textContent = timer;
}

function startTimer() {
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    timer--;
    timerCircle.textContent = timer;
    if (timer <= 0) nextQuestion();
  }, 1000);
}

function nextQuestion() {
  if (currentIndex < questions.length - 1) {
    currentIndex++;
    showQuestion();
    startTimer();
  } else {
    clearInterval(timerInterval);
    questionDiv.textContent = "ðŸŽ‰ Exam Finished!";
    optionsDiv.innerHTML = "";
    timerCircle.textContent = "";
    nextBtn.style.display = "none";
    prevBtn.style.display = "none";
    repeatBtn.style.display = "inline-block";
  }
}

function prevQuestion() {
  if (currentIndex > 0) {
    currentIndex--;
    showQuestion();
    startTimer();
  }
}

function repeatExam() {
  currentIndex = 0;
  showQuestion();
  startTimer();
  nextBtn.style.display = "inline-block";
  prevBtn.style.display = "inline-block";
  repeatBtn.style.display = "none";
}

function buildJumpList() {
  jumpSelect.innerHTML = "";
  questions.forEach((_, i) => {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = `Item ${i + 1}`;
    jumpSelect.appendChild(opt);
  });
}

jumpSelect.onchange = () => {
  currentIndex = parseInt(jumpSelect.value);
  showQuestion();
  startTimer();
};

nextBtn.onclick = nextQuestion;
prevBtn.onclick = prevQuestion;
repeatBtn.onclick = repeatExam;

// Fullscreen toggle
fullscreenBtn.onclick = () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
};

// AI Reader - Text-to-Speech
readBtn.onclick = () => {
  const synth = window.speechSynthesis;
  synth.cancel();
  const q = questions[currentIndex];
  let textToRead = `Question ${currentIndex + 1}: ${q.question}. `;
  q.options.forEach((opt, i) => {
    textToRead += `${String.fromCharCode(65 + i)}. ${opt}. `;
  });
  const utter = new SpeechSynthesisUtterance(textToRead);
  utter.lang = "en-US";
  utter.rate = 1;
  synth.speak(utter);
};
</script>

</body>
</html>
